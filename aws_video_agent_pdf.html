<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Video Generation Agent - Complete Guide</title>
    <style>
        @media print {
            body { margin: 0; padding: 20px; }
            .no-print { display: none; }
            .page-break { page-break-before: always; }
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            max-width: 900px;
            margin: 0 auto;
            padding: 40px 20px;
            background: #f5f5f5;
            color: #333;
        }
        
        .container {
            background: white;
            padding: 60px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .header {
            border-bottom: 4px solid #FF9900;
            padding-bottom: 20px;
            margin-bottom: 40px;
        }
        
        h1 {
            color: #232F3E;
            font-size: 2.5em;
            margin: 0 0 10px 0;
        }
        
        .subtitle {
            color: #666;
            font-size: 1.2em;
            margin: 0;
        }
        
        h2 {
            color: #232F3E;
            border-left: 5px solid #FF9900;
            padding-left: 15px;
            margin-top: 40px;
            font-size: 1.8em;
        }
        
        h3 {
            color: #146EB4;
            margin-top: 30px;
            font-size: 1.4em;
        }
        
        h4 {
            color: #232F3E;
            margin-top: 20px;
            font-size: 1.1em;
        }
        
        .info-box {
            background: #E7F3FF;
            border-left: 4px solid #146EB4;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .warning-box {
            background: #FFF4E5;
            border-left: 4px solid #FF9900;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        .success-box {
            background: #E8F5E9;
            border-left: 4px solid #4CAF50;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }
        
        pre {
            background: #2D2D2D;
            color: #F8F8F2;
            padding: 20px;
            border-radius: 6px;
            overflow-x: auto;
            font-size: 0.9em;
            line-height: 1.5;
        }
        
        code {
            background: #f4f4f4;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            color: #c7254e;
        }
        
        pre code {
            background: transparent;
            padding: 0;
            color: #F8F8F2;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        th {
            background: #232F3E;
            color: white;
            padding: 15px;
            text-align: left;
            font-weight: 600;
        }
        
        td {
            padding: 12px 15px;
            border-bottom: 1px solid #ddd;
        }
        
        tr:nth-child(even) {
            background: #f9f9f9;
        }
        
        tr:hover {
            background: #f5f5f5;
        }
        
        .btn {
            background: #FF9900;
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin: 20px 0;
            display: inline-block;
        }
        
        .btn:hover {
            background: #E88B00;
        }
        
        ul, ol {
            margin: 15px 0;
            padding-left: 30px;
        }
        
        li {
            margin: 8px 0;
        }
        
        .architecture-diagram {
            background: #f9f9f9;
            border: 2px solid #ddd;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre;
            overflow-x: auto;
        }
        
        .cost-highlight {
            background: #FFF9E6;
            border: 2px solid #FFD700;
            padding: 15px;
            border-radius: 5px;
            margin: 15px 0;
            font-weight: 600;
        }
        
        .section-number {
            color: #FF9900;
            font-weight: bold;
            margin-right: 10px;
        }
        
        .footer {
            margin-top: 60px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            text-align: center;
            color: #666;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé• AWS Video Generation Agent</h1>
            <p class="subtitle">Complete Production Deployment Guide</p>
            <p style="color: #666; margin-top: 10px;">Building a Scalable Video AI Platform on AWS</p>
        </div>

        <div class="info-box">
            <strong>üìã Document Overview:</strong> This guide provides complete instructions for deploying a production-ready video generation platform on AWS, capable of creating marketing videos, vlogs, animations, and social media content from text prompts.
        </div>

        <h2>1. Project Overview</h2>
        
        <h3>1.1 Use Cases</h3>
        <ul>
            <li><strong>Marketing Creatives:</strong> Product ads, campaigns, promotions</li>
            <li><strong>Personal Content:</strong> Vlogs and creative pieces</li>
            <li><strong>Educational:</strong> Animation-style explainers and tutorials</li>
            <li><strong>Social Media:</strong> Reels, YouTube Shorts, TikTok content</li>
            <li><strong>Animations:</strong> Short animated GIFs and clips</li>
        </ul>

        <h3>1.2 Sample Use Case</h3>
        <div class="success-box">
            <strong>üçú Naruto's Food Vlog (Tamil)</strong><br><br>
            <strong>Prompt:</strong> "Naruto Uzumaki in anime style is sitting at Ichiraku Ramen shop with a vlogging camera in front of him. He talks in Tamil with excitement: '‡Æá‡Æ§‡ØÅ ‡Æ§‡Ææ‡Æ©‡Øç ‡Æé‡Æ©‡Øç ‡Æ™‡Æø‡Æü‡Æø‡Æ§‡Øç‡Æ§ ‡Æ∞‡Ææ‡ÆÆ‡Æ©‡Øç! ‡Æö‡ØÇ‡Æ™‡Øç‡Æ™‡Æ∞‡Ææ ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ!' Animated subtitles in Tamil appear at the bottom. The video has a bright, colorful anime style with close-ups of ramen bowls and Naruto's happy expressions."
        </div>

        <h3>1.3 System Architecture</h3>
        <div class="architecture-diagram">
User Request
    ‚Üì
FastAPI Backend
    ‚Üì
Job Queue (Celery + Redis)
    ‚Üì
Video Generation Engine
    ‚îú‚îÄ‚îÄ Open Source Models (AnimateDiff, Stable Video)
    ‚îî‚îÄ‚îÄ Cloud APIs (Runway, Pika Labs)
    ‚Üì
Post-Processing (Audio, Subtitles)
    ‚Üì
AWS S3 Storage
    ‚Üì
Delivery to User
        </div>

        <div class="page-break"></div>

        <h2>2. AWS Infrastructure Setup</h2>

        <h3>2.1 Recommended AWS Instance</h3>
        <table>
            <tr>
                <th>Component</th>
                <th>Specification</th>
                <th>Reason</th>
            </tr>
            <tr>
                <td>Instance Type</td>
                <td>g5.2xlarge or g5.4xlarge</td>
                <td>GPU acceleration for video generation</td>
            </tr>
            <tr>
                <td>GPU</td>
                <td>NVIDIA A10G (24GB VRAM)</td>
                <td>Required for AI model inference</td>
            </tr>
            <tr>
                <td>vCPUs</td>
                <td>8-16 cores</td>
                <td>Parallel processing and queue management</td>
            </tr>
            <tr>
                <td>RAM</td>
                <td>32-64 GB</td>
                <td>Model loading and video processing</td>
            </tr>
            <tr>
                <td>Storage</td>
                <td>500GB+ SSD (gp3)</td>
                <td>Models, temporary videos, cache</td>
            </tr>
            <tr>
                <td>OS</td>
                <td>Ubuntu 22.04 LTS with Deep Learning AMI</td>
                <td>Pre-configured with CUDA and ML tools</td>
            </tr>
        </table>

        <div class="cost-highlight">
            üí∞ <strong>Estimated Cost:</strong> g5.2xlarge = ~$1.20/hour = ~$864/month (24/7)
        </div>

        <h3>2.2 Launch EC2 Instance</h3>
        
        <h4>Step 1: Access AWS Console</h4>
        <ol>
            <li>Log in to AWS Console: <code>https://console.aws.amazon.com</code></li>
            <li>Navigate to EC2 Dashboard</li>
            <li>Click "Launch Instance"</li>
        </ol>

        <h4>Step 2: Instance Configuration</h4>
        <pre><code># Name and Tags
Name: video-generation-agent

# AMI Selection
Search for: "Deep Learning AMI GPU PyTorch"
Select: Deep Learning AMI GPU PyTorch 2.0 (Ubuntu 22.04)

# Instance Type
Family: Accelerated Computing (g5)
Type: g5.2xlarge
GPU: 1x NVIDIA A10G (24GB)

# Key Pair
Create new key pair: video-agent-key.pem
Download and save securely

# Network Settings
Create security group: video-agent-sg
Allow SSH (port 22) from your IP
Allow HTTP (port 80) from anywhere
Allow HTTPS (port 443) from anywhere
Allow Custom TCP (port 8000) for API

# Storage
Volume: 500 GB gp3 SSD
IOPS: 3000
Throughput: 125 MB/s</code></pre>

        <h4>Step 3: Elastic IP (Optional but Recommended)</h4>
        <ol>
            <li>Navigate to Elastic IPs in EC2 Dashboard</li>
            <li>Allocate new Elastic IP address</li>
            <li>Associate with your instance</li>
            <li>This prevents IP changes on restart</li>
        </ol>

        <div class="page-break"></div>

        <h2>3. Server Setup & Installation</h2>

        <h3>3.1 Connect to Instance</h3>
        <pre><code># Change key permissions
chmod 400 video-agent-key.pem

# Connect via SSH
ssh -i video-agent-key.pem ubuntu@YOUR_ELASTIC_IP

# Update system
sudo apt update && sudo apt upgrade -y</code></pre>

        <h3>3.2 Install Core Dependencies</h3>
        <pre><code># Install Python and tools
sudo apt install python3.10 python3-pip git ffmpeg redis-server -y

# Install NVIDIA drivers (if not pre-installed)
nvidia-smi  # Verify GPU is detected

# Install Docker (for containerization)
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh
sudo usermod -aG docker ubuntu

# Install NVIDIA Container Toolkit
distribution=$(. /etc/os-release;echo $ID$VERSION_ID)
curl -s -L https://nvidia.github.io/nvidia-docker/gpgkey | sudo apt-key add -
curl -s -L https://nvidia.github.io/nvidia-docker/$distribution/nvidia-docker.list | \
  sudo tee /etc/apt/sources.list.d/nvidia-docker.list
sudo apt-get update && sudo apt-get install -y nvidia-docker2
sudo systemctl restart docker</code></pre>

        <h3>3.3 Install PyTorch and AI Libraries</h3>
        <pre><code># Create virtual environment
python3 -m venv /home/ubuntu/video-env
source /home/ubuntu/video-env/bin/activate

# Install PyTorch with CUDA support
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cu118

# Install video generation libraries
pip install diffusers transformers accelerate xformers
pip install opencv-python pillow moviepy
pip install fastapi uvicorn celery redis
pip install replicate openai anthropic

# Verify GPU access
python -c "import torch; print(torch.cuda.is_available())"
# Should print: True</code></pre>

        <h3>3.4 Install Video Generation Models</h3>
        <pre><code># Create models directory
mkdir -p /home/ubuntu/models
cd /home/ubuntu/models

# Download AnimateDiff (for anime-style videos)
git clone https://github.com/guoyww/AnimateDiff.git
cd AnimateDiff
pip install -r requirements.txt
python download_models.py

# Download Stable Video Diffusion
cd /home/ubuntu/models
git clone https://huggingface.co/stabilityai/stable-video-diffusion-img2vid-xt

# Download Text-to-Video models
huggingface-cli download damo-vilab/text-to-video-ms-1.7b --local-dir ./text-to-video</code></pre>

        <div class="page-break"></div>

        <h2>4. Application Deployment</h2>

        <h3>4.1 Project Structure</h3>
        <pre><code>/home/ubuntu/video-agent/
‚îú‚îÄ‚îÄ main.py                 # FastAPI application
‚îú‚îÄ‚îÄ celery_worker.py        # Background task processor
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ video_generator.py  # Video generation logic
‚îÇ   ‚îú‚îÄ‚îÄ audio_processor.py  # TTS and audio
‚îÇ   ‚îî‚îÄ‚îÄ subtitle_engine.py  # Subtitle rendering
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îú‚îÄ‚îÄ s3_upload.py        # AWS S3 integration
‚îÇ   ‚îî‚îÄ‚îÄ config.py           # Configuration
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ Dockerfile
‚îî‚îÄ‚îÄ docker-compose.yml</code></pre>

        <h3>4.2 Production FastAPI Application</h3>
        <pre><code># main.py
from fastapi import FastAPI, BackgroundTasks
from celery import Celery
import redis
import boto3
from typing import Optional

app = FastAPI(title="Video Generation Agent")

# Celery configuration
celery_app = Celery(
    'video_tasks',
    broker='redis://localhost:6379/0',
    backend='redis://localhost:6379/0'
)

# AWS S3 client
s3_client = boto3.client('s3', region_name='us-east-1')

@celery_app.task(name='generate_video_task')
def generate_video_task(job_id: str, prompt: str, style: str):
    # Video generation logic here
    # Returns S3 URL
    pass

@app.post("/api/v1/generate")
async def generate_video(request: VideoRequest):
    job_id = str(uuid.uuid4())
    
    # Queue the task
    task = generate_video_task.delay(
        job_id=job_id,
        prompt=request.prompt,
        style=request.style
    )
    
    return {"job_id": job_id, "task_id": task.id}

if __name__ == "__main__":
    import uvicorn
    uvicorn.run(app, host="0.0.0.0", port=8000, workers=4)</code></pre>

        <h3>4.3 Celery Worker Setup</h3>
        <pre><code># Start Redis
sudo systemctl start redis-server
sudo systemctl enable redis-server

# Start Celery worker
celery -A main.celery_app worker --loglevel=info --concurrency=2

# For production, use systemd service
sudo nano /etc/systemd/system/celery-worker.service</code></pre>

        <h3>4.4 Systemd Service Configuration</h3>
        <pre><code>[Unit]
Description=Celery Worker for Video Generation
After=network.target redis.service

[Service]
Type=forking
User=ubuntu
Group=ubuntu
WorkingDirectory=/home/ubuntu/video-agent
Environment="PATH=/home/ubuntu/video-env/bin"
ExecStart=/home/ubuntu/video-env/bin/celery -A main.celery_app worker \
          --loglevel=info --concurrency=2 --pidfile=/var/run/celery.pid

[Install]
WantedBy=multi-user.target</code></pre>

        <div class="page-break"></div>

        <h2>5. Storage & S3 Setup</h2>

        <h3>5.1 Create S3 Bucket</h3>
        <pre><code># Using AWS CLI
aws s3 mb s3://video-generation-outputs --region us-east-1

# Set bucket policy for public read (optional)
aws s3api put-bucket-policy --bucket video-generation-outputs \
    --policy file://bucket-policy.json

# Enable versioning
aws s3api put-bucket-versioning --bucket video-generation-outputs \
    --versioning-configuration Status=Enabled</code></pre>

        <h3>5.2 S3 Upload Integration</h3>
        <pre><code># utils/s3_upload.py
import boto3
from pathlib import Path

class S3Uploader:
    def __init__(self, bucket_name):
        self.s3 = boto3.client('s3')
        self.bucket = bucket_name
    
    def upload_video(self, local_path: Path, job_id: str):
        key = f"videos/{job_id}.mp4"
        
        self.s3.upload_file(
            str(local_path),
            self.bucket,
            key,
            ExtraArgs={
                'ContentType': 'video/mp4',
                'ACL': 'public-read'
            }
        )
        
        url = f"https://{self.bucket}.s3.amazonaws.com/{key}"
        return url</code></pre>

        <h3>5.3 CloudFront CDN (Optional)</h3>
        <div class="info-box">
            <strong>Why CloudFront?</strong>
            <ul>
                <li>Faster video delivery globally</li>
                <li>Reduced S3 bandwidth costs</li>
                <li>HTTPS by default</li>
                <li>Custom domain support</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <h2>6. Cost Optimization Strategies</h2>

        <h3>6.1 Cost Breakdown</h3>
        <table>
            <tr>
                <th>Component</th>
                <th>Strategy</th>
                <th>Monthly Cost</th>
            </tr>
            <tr>
                <td>EC2 g5.2xlarge (24/7)</td>
                <td>On-Demand</td>
                <td>~$864</td>
            </tr>
            <tr>
                <td>EC2 g5.2xlarge (8 hrs/day)</td>
                <td>Stop when not in use</td>
                <td>~$288</td>
            </tr>
            <tr>
                <td>EC2 g5.2xlarge</td>
                <td>Spot Instance (70% off)</td>
                <td>~$260</td>
            </tr>
            <tr>
                <td>S3 Storage (1TB)</td>
                <td>Standard</td>
                <td>~$23</td>
            </tr>
            <tr>
                <td>S3 Transfer Out (500GB)</td>
                <td>Data egress</td>
                <td>~$45</td>
            </tr>
            <tr>
                <td>CloudFront (optional)</td>
                <td>CDN delivery</td>
                <td>~$20</td>
            </tr>
        </table>

        <div class="cost-highlight">
            üí° <strong>Recommended Setup:</strong> Spot Instance + Scheduled Scaling = ~$300-400/month
        </div>

        <h3>6.2 Spot Instance Setup</h3>
        <pre><code># Request spot instance with 70% discount
aws ec2 request-spot-instances \
    --instance-count 1 \
    --type "persistent" \
    --launch-specification file://spot-config.json

# spot-config.json
{
  "ImageId": "ami-xxxxxxxxx",
  "InstanceType": "g5.2xlarge",
  "KeyName": "video-agent-key",
  "SecurityGroupIds": ["sg-xxxxxxxxx"],
  "IamInstanceProfile": {
    "Name": "video-agent-role"
  }
}</code></pre>

        <h3>6.3 Auto-Scaling Configuration</h3>
        <pre><code># Schedule to run only during business hours
# Start at 8 AM, Stop at 6 PM

# Create Lambda function for auto-start/stop
# CloudWatch Events trigger Lambda at scheduled times</code></pre>

        <div class="page-break"></div>

        <h2>7. Model Selection Guide</h2>

        <h3>7.1 Open Source Models (Self-Hosted)</h3>
        <table>
            <tr>
                <th>Model</th>
                <th>Best For</th>
                <th>Quality</th>
                <th>Speed</th>
                <th>VRAM</th>
            </tr>
            <tr>
                <td>AnimateDiff</td>
                <td>Anime, cartoons</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>2-3 min</td>
                <td>16GB</td>
            </tr>
            <tr>
                <td>Stable Video Diffusion</td>
                <td>Realistic, img2vid</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>3-5 min</td>
                <td>20GB</td>
            </tr>
            <tr>
                <td>ModelScope</td>
                <td>General purpose</td>
                <td>‚≠ê‚≠ê‚≠ê</td>
                <td>1-2 min</td>
                <td>12GB</td>
            </tr>
            <tr>
                <td>Zeroscope</td>
                <td>High quality text2vid</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>4-6 min</td>
                <td>24GB</td>
            </tr>
        </table>

        <h3>7.2 Cloud API Services</h3>
        <table>
            <tr>
                <th>Service</th>
                <th>Cost per Video</th>
                <th>Quality</th>
                <th>Speed</th>
            </tr>
            <tr>
                <td>Runway Gen-3</td>
                <td>$0.50 - $1.00</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>30-60 sec</td>
            </tr>
            <tr>
                <td>Pika Labs</td>
                <td>$0.10 - $0.30</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>20-40 sec</td>
            </tr>
            <tr>
                <td>Stability AI</td>
                <td>$0.05 - $0.15</td>
                <td>‚≠ê‚≠ê‚≠ê‚≠ê</td>
                <td>30-50 sec</td>
            </tr>
            <tr>
                <td>Replicate</td>
                <td>$0.02 - $0.05</td>
                <td>‚≠ê‚≠ê‚≠ê</td>
                <td>30-60 sec</td>
            </tr>
        </table>

        <h3>7.3 Hybrid Strategy (Recommended)</h3>
        <div class="success-box">
            <strong>Smart Cost Optimization:</strong>
            <ul>
                <li><strong>Low-priority/Batch:</strong> Use self-hosted models overnight</li>
                <li><strong>High-priority:</strong> Use cloud APIs for instant delivery</li>
                <li><strong>Anime content:</strong> AnimateDiff (self-hosted)</li>
                <li><strong>Realistic ads:</strong> Runway Gen-3 (API)</li>
            </ul>
            <strong>Result:</strong> 50-70% cost reduction vs. all-API approach
        </div>

        <div class="page-break"></div>

        <h2>8. Tamil Language Integration</h2>

        <h3>8.1 Text-to-Speech (Tamil)</h3>
        <pre><code># Install Tamil TTS
pip install TTS gTTS

# Using Coqui TTS (Open Source)
from TTS.api import TTS

tts = TTS("tts_models/ta/mai/vits")
tts.tts_to_file(
    text="‡Æá‡Æ§‡ØÅ ‡Æ§‡Ææ‡Æ©‡Øç ‡Æé‡Æ©‡Øç ‡Æ™‡Æø‡Æü‡Æø‡Æ§‡Øç‡Æ§ ‡Æ∞‡Ææ‡ÆÆ‡Æ©‡Øç! ‡Æö‡ØÇ‡Æ™‡Øç‡Æ™‡Æ∞‡Ææ ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ!",
    file_path="tamil_audio.wav"
)

# Alternative: Google TTS (Cloud)
from gtts import gTTS

tts = gTTS("‡Æá‡Æ§‡ØÅ ‡Æ§‡Ææ‡Æ©‡Øç ‡Æé‡Æ©‡Øç ‡Æ™‡Æø‡Æü‡Æø‡Æ§‡Øç‡Æ§ ‡Æ∞‡Ææ‡ÆÆ‡Æ©‡Øç", lang='ta')
tts.save("output.mp3")</code></pre>

        <h3>8.2 Tamil Subtitle Rendering</h3>
        <pre><code># Install Tamil font support
sudo apt install fonts-lohit-tamil fonts-tamil -y

# FFmpeg subtitle rendering with Tamil font
ffmpeg -i input.mp4 \
    -vf "subtitles=subtitles.srt:force_style='FontName=Lohit Tamil,Fontsize=24'" \
    -c:a copy output.mp4

# Subtitles.srt format
1
00:00:00,000 --> 00:00:03,000
‡Æá‡Æ§‡ØÅ ‡Æ§‡Ææ‡Æ©‡Øç ‡Æé‡Æ©‡Øç ‡Æ™‡Æø‡Æü‡Æø‡Æ§‡Øç‡Æ§ ‡Æ∞‡Ææ‡ÆÆ‡Æ©‡Øç!

2
00:00:03,000 --> 00:00:05,000
‡Æö‡ØÇ‡Æ™‡Øç‡Æ™‡Æ∞‡Ææ ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï‡ØÅ!</code></pre>

        <h3>8.3 Multi-Language Support</h3>
        <pre><code># Language detection and processing
SUPPORTED_LANGUAGES = {
    'tamil': {'code': 'ta', 'tts': 'ta-IN-Standard-A'},
    'english': {'code': 'en', 'tts': 'en-US-Standard-C'},
    'hindi': {'code': 'hi', 'tts': 'hi-IN-Standard-A'}
}</code></pre>

        <div class="page-break"></div>

        <h2>9. Monitoring & Maintenance</h2>

        <h3>9.1 CloudWatch Monitoring</h3>
        <pre><code># Install CloudWatch agent
wget https://s3.amazonaws.com/amazoncloudwatch-agent/ubuntu/amd64/latest/amazon-cloudwatch-agent.deb
sudo dpkg -i amazon-cloudwatch-agent.deb

# Configure metrics
sudo /opt/aws/amazon-cloudwatch-agent/bin/amazon-cloudwatch-agent-ctl \
    -a fetch-config \
    -m ec2 \
    -s \
    -c file:/opt/aws/amazon-cloudwatch-agent/etc/config.json</code></pre>

        <h3>9.2 Key Metrics to Monitor</h3>
        <table>
            <tr>
                <th>Metric</th>
                <th>Threshold</th>
                <th>Action</th>
            </tr>
            <tr>
                <td>GPU Utilization</td>
                <td>&gt; 90%</td>
                <td>Scale up or queue jobs</td>
            </tr>
            <tr>
                <td>Memory Usage</td>
                <td>&gt; 85%</td>
                <td>Restart services</td>
            </tr>
            <tr>
                <td>Disk Space</td>
                <td>&gt; 80%</td>
                <td>Clean temp files</td>
            </tr>
            <tr>
                <td>Queue Length</td>
                <td>&gt; 50</td>
                <td>Add worker instances</td>
            </tr>
            <tr>
                <td>API Response Time</td>
                <td>&gt; 5 sec</td>
                <td>Check bottlenecks</td>
            </tr>
        </table>

        <h3>9.3 Logging Setup</h3>
        <pre><code># Install logging tools
pip install python-json-logger

# Configure structured logging
import logging
from pythonjsonlogger import jsonlogger

logger = logging.getLogger()
logHandler = logging.StreamHandler()
formatter = jsonlogger.JsonFormatter()
logHandler.setFormatter(formatter)
logger.addHandler(logHandler)

# Log to CloudWatch
import watchtower
logger.addHandler(watchtower.CloudWatchLogHandler())</code></pre>

        <h3>9.4 Backup Strategy</h3>
        <div class="info-box">
            <strong>Backup Components:</strong>
            <ul>
                <li><strong>EBS Snapshots:</strong> Daily automated snapshots</li>
                <li><strong>S3 Versioning:</strong> Enabled for video outputs</li>
                <li><strong>Model Backups:</strong> Weekly backup to S3</li>
                <li><strong>Database:</strong> Redis RDB dumps every 6 hours</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <h2>10. Security Best Practices</h2>

        <h3>10.1 IAM Roles & Permissions</h3>
        <pre><code># Create IAM role for EC2 instance
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": [
        "s3:PutObject",
        "s3:GetObject",
        "s3:ListBucket"
      ],
      "Resource": [
        "arn:aws:s3:::video-generation-outputs/*"
      ]
    },
    {
      "Effect": "Allow",
      "Action": [
        "cloudwatch:PutMetricData",
        "logs:CreateLogGroup",
        "logs:CreateLogStream",
        "logs:PutLogEvents"
      ],
      "Resource": "*"
    }
  ]
}</code></pre>

        <h3>10.2 Security Group Configuration</h3>
        <table>
            <tr>
                <th>Port</th>
                <th>Protocol</th>
                <th>Source</th>
                <th>Purpose</th>
            </tr>
            <tr>
                <td>22</td>
                <td>TCP</td>
                <td>Your IP only</td>
                <td>SSH access</td>
            </tr>
            <tr>
                <td>80</td>
                <td>TCP</td>
                <td>0.0.0.0/0</td>
                <td>HTTP (redirect to HTTPS)</td>
            </tr>
            <tr>
                <td>443</td>
                <td>TCP</td>
                <td>0.0.0.0/0</td>
                <td>HTTPS API access</td>
            </tr>
            <tr>
                <td>8000</td>
                <td>TCP</td>
                <td>VPC only</td>
                <td>Internal API</td>
            </tr>
        </table>

        <h3>10.3 API Authentication</h3>
        <pre><code># Implement API key authentication
from fastapi import Security, HTTPException
from fastapi.security.api_key import APIKeyHeader

API_KEY = "your-secure-api-key-here"
api_key_header = APIKeyHeader(name="X-API-Key")

async def get_api_key(api_key: str = Security(api_key_header)):
    if api_key != API_KEY:
        raise HTTPException(status_code=403, detail="Invalid API Key")
    return api_key

@app.post("/generate")
async def generate(request: VideoRequest, api_key: str = Depends(get_api_key)):
    # Your logic here
    pass</code></pre>

        <div class="page-break"></div>

        <h2>11. Deployment Checklist</h2>

        <div class="success-box">
            <h3>‚úÖ Pre-Launch Checklist</h3>
            <ul>
                <li>‚òê EC2 instance launched with GPU</li>
                <li>‚òê CUDA and PyTorch installed</li>
                <li>‚òê All models downloaded and tested</li>
                <li>‚òê Redis and Celery configured</li>
                <li>‚òê S3 bucket created and permissions set</li>
                <li>‚òê CloudWatch monitoring enabled</li>
                <li>‚òê Security groups configured</li>
                <li>‚òê Backup strategy implemented</li>
                <li>‚òê API authentication enabled</li>
                <li>‚òê Test videos generated successfully</li>
                <li>‚òê Tamil TTS and subtitles working</li>
                <li>‚òê Cost alerts configured</li>
            </ul>
        </div>

        <h3>11.1 Testing Commands</h3>
        <pre><code># Test GPU
nvidia-smi

# Test PyTorch GPU
python -c "import torch; print(torch.cuda.is_available())"

# Test Redis
redis-cli ping

# Test API
curl -X POST http://localhost:8000/generate \
    -H "Content-Type: application/json" \
    -d '{"prompt": "test video", "style": "anime"}'

# Test S3 upload
aws s3 ls s3://video-generation-outputs/</code></pre>

        <div class="page-break"></div>

        <h2>12. Scaling Strategy</h2>

        <h3>12.1 Horizontal Scaling</h3>
        <div class="info-box">
            <strong>When to Scale:</strong>
            <ul>
                <li>Queue length consistently &gt; 20 jobs</li>
                <li>Average wait time &gt; 10 minutes</li>
                <li>GPU utilization &gt; 90% for extended periods</li>
            </ul>
        </div>

        <h3>12.2 Load Balancer Setup</h3>
        <pre><code># Create Application Load Balancer
aws elbv2 create-load-balancer \
    --name video-agent-alb \
    --subnets subnet-xxx subnet-yyy \
    --security-groups sg-zzz

# Configure target group
aws elbv2 create-target-group \
    --name video-agent-targets \
    --protocol HTTP \
    --port 8000 \
    --vpc-id vpc-xxx</code></pre>

        <h3>12.3 Auto Scaling Group</h3>
        <table>
            <tr>
                <th>Metric</th>
                <th>Scale Up</th>
                <th>Scale Down</th>
            </tr>
            <tr>
                <td>GPU Utilization</td>
                <td>&gt; 80% for 5 min</td>
                <td>&lt; 30% for 10 min</td>
            </tr>
            <tr>
                <td>Queue Length</td>
                <td>&gt; 30 jobs</td>
                <td>&lt; 5 jobs</td>
            </tr>
            <tr>
                <td>Min Instances</td>
                <td colspan="2">1</td>
            </tr>
            <tr>
                <td>Max Instances</td>
                <td colspan="2">5</td>
            </tr>
        </table>

        <div class="page-break"></div>

        <h2>13. Cost Comparison Scenarios</h2>

        <h3>13.1 Monthly Cost Breakdown</h3>
        <table>
            <tr>
                <th>Scenario</th>
                <th>Videos/Month</th>
                <th>Strategy</th>
                <th>Monthly Cost</th>
            </tr>
            <tr>
                <td>Light Usage</td>
                <td>100-300</td>
                <td>Replicate API only</td>
                <td>$5-$15</td>
            </tr>
            <tr>
                <td>Medium Usage</td>
                <td>500-1000</td>
                <td>Spot instance + API</td>
                <td>$300-$400</td>
            </tr>
            <tr>
                <td>Heavy Usage</td>
                <td>2000+</td>
                <td>On-demand 24/7</td>
                <td>$900-$1200</td>
            </tr>
            <tr>
                <td>Enterprise</td>
                <td>10000+</td>
                <td>Multi-instance cluster</td>
                <td>$3000-$5000</td>
            </tr>
        </table>

        <div class="cost-highlight">
            üí° <strong>Break-even Point:</strong> Self-hosting becomes cost-effective at ~500 videos/month
        </div>

        <h3>13.2 Cost per Video Comparison</h3>
        <table>
            <tr>
                <th>Method</th>
                <th>Cost/Video</th>
                <th>Quality</th>
                <th>Speed</th>
            </tr>
            <tr>
                <td>Self-hosted (g5.2xlarge)</td>
                <td>$0.02-$0.04</td>
                <td>High</td>
                <td>2-5 min</td>
            </tr>
            <tr>
                <td>Replicate API</td>
                <td>$0.02-$0.05</td>
                <td>Good</td>
                <td>30-60 sec</td>
            </tr>
            <tr>
                <td>Runway Gen-3</td>
                <td>$0.50-$1.00</td>
                <td>Excellent</td>
                <td>30-60 sec</td>
            </tr>
            <tr>
                <td>Pika Labs</td>
                <td>$0.10-$0.30</td>
                <td>Very Good</td>
                <td>20-40 sec</td>
            </tr>
        </table>

        <div class="page-break"></div>

        <h2>14. Production Optimization Tips</h2>

        <h3>14.1 Performance Optimization</h3>
        <div class="success-box">
            <strong>Speed Improvements:</strong>
            <ul>
                <li><strong>Model Caching:</strong> Keep models loaded in memory</li>
                <li><strong>Batch Processing:</strong> Process similar requests together</li>
                <li><strong>GPU Optimization:</strong> Use FP16 precision (2x faster)</li>
                <li><strong>Smart Scheduling:</strong> Queue management with priorities</li>
                <li><strong>CDN Caching:</strong> Cache popular content</li>
            </ul>
        </div>

        <h3>14.2 Quality Optimization</h3>
        <pre><code># Use these settings for best quality
generation_config = {
    "num_inference_steps": 50,  # Higher = better quality
    "guidance_scale": 7.5,       # 7-8 is optimal
    "num_frames": 120,           # 5 sec at 24fps
    "height": 512,
    "width": 512,
    "negative_prompt": "blurry, low quality, distorted"
}</code></pre>

        <h3>14.3 Cache Strategy</h3>
        <pre><code># Implement result caching
import hashlib
import redis

redis_client = redis.Redis()

def get_cached_video(prompt):
    cache_key = hashlib.md5(prompt.encode()).hexdigest()
    return redis_client.get(f"video:{cache_key}")

def cache_video(prompt, video_url):
    cache_key = hashlib.md5(prompt.encode()).hexdigest()
    redis_client.setex(f"video:{cache_key}", 86400, video_url)  # 24h TTL</code></pre>

        <div class="page-break"></div>

        <h2>15. Troubleshooting Guide</h2>

        <h3>15.1 Common Issues</h3>
        <table>
            <tr>
                <th>Issue</th>
                <th>Symptom</th>
                <th>Solution</th>
            </tr>
            <tr>
                <td>Out of Memory</td>
                <td>CUDA OOM error</td>
                <td>Reduce batch size, use FP16, clear cache</td>
            </tr>
            <tr>
                <td>Slow Generation</td>
                <td>&gt;10 min per video</td>
                <td>Check GPU utilization, reduce inference steps</td>
            </tr>
            <tr>
                <td>Queue Backup</td>
                <td>Long wait times</td>
                <td>Add workers, scale instances</td>
            </tr>
            <tr>
                <td>Poor Quality</td>
                <td>Blurry videos</td>
                <td>Increase inference steps, check prompt</td>
            </tr>
            <tr>
                <td>Tamil Font Issues</td>
                <td>Broken text</td>
                <td>Install Tamil fonts, specify font in FFmpeg</td>
            </tr>
        </table>

        <h3>15.2 Debug Commands</h3>
        <pre><code># Check GPU status
nvidia-smi

# Monitor GPU in real-time
watch -n 1 nvidia-smi

# Check Celery workers
celery -A main.celery_app status

# View worker logs
journalctl -u celery-worker -f

# Check Redis queue
redis-cli llen celery

# Monitor disk space
df -h

# Check memory usage
free -m</code></pre>

        <div class="page-break"></div>

        <h2>16. Next Steps & Roadmap</h2>

        <h3>16.1 Phase 1: MVP (Week 1-2)</h3>
        <ul>
            <li>Launch EC2 instance</li>
            <li>Install dependencies</li>
            <li>Deploy basic API</li>
            <li>Test with 10-20 videos</li>
            <li>Validate Tamil integration</li>
        </ul>

        <h3>16.2 Phase 2: Production (Week 3-4)</h3>
        <ul>
            <li>Implement queue system</li>
            <li>Add monitoring</li>
            <li>Set up S3 and CDN</li>
            <li>Configure backups</li>
            <li>Load testing</li>
        </ul>

        <h3>16.3 Phase 3: Scale (Month 2)</h3>
        <ul>
            <li>Auto-scaling setup</li>
            <li>Multi-model support</li>
            <li>Advanced features</li>
            <li>Performance optimization</li>
            <li>User dashboard</li>
        </ul>

        <h3>16.4 Future Enhancements</h3>
        <div class="info-box">
            <strong>Feature Ideas:</strong>
            <ul>
                <li>üì± Mobile app integration</li>
                <li>üé® Custom style training</li>
                <li>üéµ Background music generation</li>
                <li>ü§ñ AI voice cloning</li>
                <li>üìä Analytics dashboard</li>
                <li>üåç Multi-language support (10+ languages)</li>
                <li>‚ö° Real-time video generation</li>
                <li>üé¨ Long-form video support (60+ seconds)</li>
            </ul>
        </div>

        <div class="page-break"></div>

        <h2>17. Quick Reference</h2>

        <h3>17.1 Essential Commands</h3>
        <div class="architecture-diagram">
# Start services
sudo systemctl start redis-server
sudo systemctl start celery-worker
python main.py

# Stop services
sudo systemctl stop celery-worker
sudo systemctl stop redis-server

# Check status
sudo systemctl status celery-worker
nvidia-smi
redis-cli ping

# View logs
journalctl -u celery-worker -f
tail -f /var/log/video-agent/app.log

# Backup
aws s3 sync /home/ubuntu/models s3://backup-bucket/models/
        </div>

        <h3>17.2 Important URLs</h3>
        <table>
            <tr>
                <th>Service</th>
                <th>URL</th>
            </tr>
            <tr>
                <td>API Endpoint</td>
                <td>http://YOUR_IP:8000</td>
            </tr>
            <tr>
                <td>API Docs</td>
                <td>http://YOUR_IP:8000/docs</td>
            </tr>
            <tr>
                <td>S3 Bucket</td>
                <td>s3://video-generation-outputs</td>
            </tr>
            <tr>
                <td>CloudWatch</td>
                <td>console.aws.amazon.com/cloudwatch</td>
            </tr>
        </table>

        <h3>17.3 Support Resources</h3>
        <ul>
            <li><strong>AWS Documentation:</strong> docs.aws.amazon.com</li>
            <li><strong>Diffusers Library:</strong> huggingface.co/docs/diffusers</li>
            <li><strong>AnimateDiff:</strong> github.com/guoyww/AnimateDiff</li>
            <li><strong>FastAPI:</strong> fastapi.tiangolo.com</li>
            <li><strong>Celery:</strong> docs.celeryproject.org</li>
        </ul>

        <div class="page-break"></div>

        <h2>18. Contact & Support</h2>

        <div class="warning-box">
            <strong>‚ö†Ô∏è Important Notes:</strong>
            <ul>
                <li>Always test in development before production</li>
                <li>Monitor costs daily during initial phase</li>
                <li>Set up billing alerts in AWS</li>
                <li>Keep API keys secure and rotate regularly</li>
                <li>Implement rate limiting to prevent abuse</li>
                <li>Regular backups are essential</li>
            </ul>
        </div>

        <div class="success-box">
            <h3>üéâ Ready to Launch!</h3>
            <p>You now have everything needed to deploy a production-ready video generation platform on AWS. Start with the M1 testing phase, validate your concept, then deploy to AWS when ready to scale.</p>
            
            <p><strong>Estimated Timeline:</strong></p>
            <ul>
                <li>M1 Testing: 3-5 days</li>
                <li>AWS Setup: 2-3 days</li>
                <li>Production Ready: 7-10 days</li>
            </ul>
        </div>

        <div class="footer">
            <p><strong>Document Version:</strong> 1.0</p>
            <p><strong>Last Updated:</strong> December 2025</p>
            <p><strong>Platform:</strong> AWS Video Generation Agent</p>
            <hr style="margin: 20px 0;">
            <button class="btn no-print" onclick="window.print()">üìÑ Download as PDF</button>
        </div>
    </div>

    <script>
        // Add print-friendly features
        document.querySelector('.btn').addEventListener('click', function() {
            window.print();
        });
    </script>
</body>
</html>